# é‹å­å•†å“ç®¡ç†ç³»çµ± API éœ€æ±‚æ–‡ä»¶

## æ–‡ä»¶è³‡è¨Š

| é …ç›® | å…§å®¹ |
|------|------|
| **API åç¨±** | é‹å­å•†å“ç®¡ç†ç³»çµ± API |
| **ç‰ˆæœ¬** | v1.0 |
| **æ–‡ä»¶ç‰ˆæœ¬** | 1.0.0 |
| **æœ€å¾Œæ›´æ–°** | 2026-02-08 |
| **è² è²¬äºº** | é–‹ç™¼åœ˜éšŠ |
| **ç‹€æ…‹** | éœ€æ±‚è¦æ ¼ |

---

## ç›®éŒ„

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [åŸºæœ¬è³‡è¨Š](#åŸºæœ¬è³‡è¨Š)
3. [èªè­‰èˆ‡æˆæ¬Š](#èªè­‰èˆ‡æˆæ¬Š)
4. [è³‡æ–™æ¨¡å‹](#è³‡æ–™æ¨¡å‹)
5. [API ç«¯é»è¦æ ¼](#api-ç«¯é»è¦æ ¼)
6. [éŒ¯èª¤è™•ç†](#éŒ¯èª¤è™•ç†)
7. [é™æµèˆ‡é…é¡](#é™æµèˆ‡é…é¡)
8. [è®Šæ›´æ—¥èªŒ](#è®Šæ›´æ—¥èªŒ)

---

## æ¦‚è¿°

### ç›®çš„
æä¾› RESTful API ä»‹é¢ï¼Œè®“çˆ¬èŸ²ç³»çµ±æˆ–å…¶ä»–å®¢æˆ¶ç«¯èƒ½å¤ ç®¡ç†é‹å­å•†å“è³‡æ–™ï¼Œå–ä»£ç›´æ¥å­˜å–è³‡æ–™åº«çš„æ–¹å¼ï¼Œæå‡ç³»çµ±å®‰å…¨æ€§ã€å¯ç¶­è­·æ€§èˆ‡å¯æ“´å±•æ€§ã€‚

### ä¸»è¦åŠŸèƒ½
- å•†å“è³‡æ–™æŸ¥è©¢èˆ‡ç‹€æ…‹æª¢æŸ¥
- å•†å“è³‡æ–™æ–°å¢ã€æ›´æ–°ã€åˆªé™¤
- æ‰¹æ¬¡ç®¡ç†è³‡æ–™è¡¨
- ç³»çµ±å¥åº·æª¢æŸ¥
- å•†å“ç·¨è™Ÿæ¸…å–®æŸ¥è©¢

### ç›®æ¨™ä½¿ç”¨è€…
- å•†å“çˆ¬èŸ²ç³»çµ±
- å…§éƒ¨ç®¡ç†ç³»çµ±
- è³‡æ–™åˆ†æå·¥å…·
- ç¬¬ä¸‰æ–¹æ•´åˆæœå‹™

---

## åŸºæœ¬è³‡è¨Š

### Base URL

| ç’°å¢ƒ | URL |
|------|-----|
| é–‹ç™¼ç’°å¢ƒ | `http://localhost:5000/api` |
| æ¸¬è©¦ç’°å¢ƒ | `http://test-api.example.com/api` |
| æ­£å¼ç’°å¢ƒ | `https://api.example.com/api` |

### é€šè¨Šå”å®š
- é–‹ç™¼/æ¸¬è©¦ç’°å¢ƒï¼šHTTP
- æ­£å¼ç’°å¢ƒï¼šHTTPSï¼ˆå¼·åˆ¶ï¼‰

### è³‡æ–™æ ¼å¼
- è«‹æ±‚æ ¼å¼ï¼š`application/json`
- å›æ‡‰æ ¼å¼ï¼š`application/json`
- å­—å…ƒç·¨ç¢¼ï¼š`UTF-8`

### API ç‰ˆæœ¬æ§åˆ¶
- æ–¹å¼ï¼šURL è·¯å¾‘ç‰ˆæœ¬æ§åˆ¶
- æ ¼å¼ï¼š`/api/v1/...`
- ç•¶å‰ç‰ˆæœ¬ï¼š`v1`

---

## èªè­‰èˆ‡æˆæ¬Š

### èªè­‰æ–¹å¼

#### æ–¹æ¡ˆä¸€ï¼šAPI Keyï¼ˆå»ºè­°åˆæœŸä½¿ç”¨ï¼‰

**è«‹æ±‚æ¨™é ­**ï¼š
```http
X-API-Key: your-api-key-here
```

**ç”³è«‹æµç¨‹**ï¼š
1. å‘ç³»çµ±ç®¡ç†å“¡ç”³è«‹ API Key
2. æ”¶åˆ° API Key å¾Œå¦¥å–„ä¿ç®¡
3. åœ¨æ¯å€‹ API è«‹æ±‚ä¸­åŒ…å«æ­¤æ¨™é ­

**ç¯„ä¾‹**ï¼š
```bash
curl -X GET https://api.example.com/api/shoes/codes \
  -H "X-API-Key: abc123def456ghi789"
```

#### æ–¹æ¡ˆäºŒï¼šJWT Tokenï¼ˆé€²éšä½¿ç”¨ï¼‰

**å–å¾— Token**ï¼š
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "crawler_user",
  "password": "secure_password"
}
```

**å›æ‡‰**ï¼š
```json
{
  "status": "success",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expires_in": 3600
}
```

**ä½¿ç”¨ Token**ï¼š
```http
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### æ¬Šé™ç­‰ç´š

| ç­‰ç´š | èªªæ˜ | å…è¨±æ“ä½œ |
|------|------|---------|
| **READ** | å”¯è®€æ¬Šé™ | æŸ¥è©¢ã€å¥åº·æª¢æŸ¥ |
| **WRITE** | å¯«å…¥æ¬Šé™ | æ–°å¢ã€æ›´æ–° |
| **DELETE** | åˆªé™¤æ¬Šé™ | åˆªé™¤å•†å“ã€æ¸…ç©ºè³‡æ–™è¡¨ |
| **ADMIN** | ç®¡ç†å“¡æ¬Šé™ | æ‰€æœ‰æ“ä½œ |

---

## è³‡æ–™æ¨¡å‹

### å•†å“æ¨¡å‹ (Shoe)

```json
{
  "id": "integer (è‡ªå‹•ç”Ÿæˆ)",
  "name": "string (å¿…å¡«, max: 200)",
  "eng_name": "string (å¿…å¡«, max: 200)",
  "code": "string (å¿…å¡«, unique, max: 50)",
  "hope_price": "string (é¸å¡«, max: 20)",
  "price": "string (å¿…å¡«, max: 20)",
  "point": "string (é¸å¡«, max: 20)",
  "size": "string (é¸å¡«, max: 500, é€—è™Ÿåˆ†éš”)",
  "created_at": "datetime (è‡ªå‹•ç”Ÿæˆ)",
  "updated_at": "datetime (è‡ªå‹•æ›´æ–°)"
}
```

#### æ¬„ä½èªªæ˜

| æ¬„ä½åç¨± | é¡å‹ | å¿…å¡« | èªªæ˜ | ç¯„ä¾‹ |
|---------|------|------|------|------|
| `id` | Integer | å¦ | ç³»çµ±è‡ªå‹•ç”Ÿæˆçš„ ID | `123` |
| `name` | String | æ˜¯ | å•†å“åç¨±ï¼ˆæ—¥æ–‡ï¼‰ | `ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹` |
| `eng_name` | String | æ˜¯ | å•†å“åç¨±ï¼ˆè‹±æ–‡ï¼‰ | `Nike Air Max` |
| `code` | String | æ˜¯ | å•†å“ç·¨è™Ÿï¼ˆå”¯ä¸€å€¼ï¼‰ | `ABC123` |
| `hope_price` | String | å¦ | å¸Œæœ›å”®åƒ¹ | `8000` |
| `price` | String | æ˜¯ | å¯¦éš›å”®åƒ¹ | `5000` |
| `point` | String | å¦ | ç´…åˆ©é»æ•¸ | `500` |
| `size` | String | å¦ | å¯ç”¨å°ºå¯¸ï¼ˆé€—è™Ÿåˆ†éš”ï¼‰ | `27.0, 28.0, 29.0` |
| `created_at` | DateTime | å¦ | å»ºç«‹æ™‚é–“ï¼ˆISO 8601ï¼‰ | `2026-02-08T10:30:00Z` |
| `updated_at` | DateTime | å¦ | æ›´æ–°æ™‚é–“ï¼ˆISO 8601ï¼‰ | `2026-02-08T15:45:00Z` |

#### æ¬„ä½é™åˆ¶

- `code`: åªå…è¨±è‹±æ•¸å­—ï¼Œ3-50 å­—å…ƒ
- `price`: æ•¸å­—å­—ä¸²ï¼Œ0-999999
- `size`: é€—è™Ÿåˆ†éš”çš„å°ºå¯¸åˆ—è¡¨

---

## API ç«¯é»è¦æ ¼

### 1. å¥åº·æª¢æŸ¥

#### 1.1 è³‡æ–™åº«å¥åº·æª¢æŸ¥

**ç«¯é»**ï¼š`GET /health/database`

**æè¿°**ï¼šæª¢æŸ¥è³‡æ–™åº«é€£ç·šç‹€æ…‹èˆ‡å›æ‡‰æ™‚é–“

**æ¬Šé™**ï¼šç„¡éœ€èªè­‰

**è«‹æ±‚åƒæ•¸**ï¼šç„¡

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "database": "connected",
  "response_time_ms": 15.23,
  "timestamp": "2026-02-08T10:30:00Z"
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šè³‡æ–™åº«é€£ç·šæ­£å¸¸
- `503 Service Unavailable`ï¼šè³‡æ–™åº«é€£ç·šå¤±æ•—

**ç¯„ä¾‹**ï¼š
```bash
curl -X GET http://localhost:5000/api/health/database
```

---

### 2. å•†å“ç®¡ç†

#### 2.1 æª¢æŸ¥å•†å“ç‹€æ…‹

**ç«¯é»**ï¼š`POST /shoes/check-status`

**æè¿°**ï¼šæª¢æŸ¥å•†å“æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ˜¯å¦éœ€è¦æ›´æ–°è³‡æ–™

**æ¬Šé™**ï¼šREAD

**è«‹æ±‚æ¨™é ­**ï¼š
```http
Content-Type: application/json
X-API-Key: your-api-key
```

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "code": "ABC123",
  "price": "5000",
  "size": "27.0, 28.0"
}
```

**è«‹æ±‚åƒæ•¸èªªæ˜**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `code` | String | æ˜¯ | å•†å“ç·¨è™Ÿ |
| `price` | String | æ˜¯ | åƒ¹æ ¼ï¼ˆç”¨æ–¼æ¯”å°ï¼‰ |
| `size` | String | æ˜¯ | å°ºå¯¸ï¼ˆç”¨æ–¼æ¯”å°ï¼‰ |

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "action_required": 0,
  "message": "å•†å“è³‡æ–™ç„¡éœ€æ›´æ–°",
  "existing_data": {
    "id": 123,
    "name": "ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹",
    "eng_name": "Nike Air Max",
    "code": "ABC123",
    "hope_price": "8000",
    "price": "5000",
    "point": "500",
    "size": "27.0, 28.0",
    "created_at": "2026-02-01T10:00:00Z",
    "updated_at": "2026-02-08T10:30:00Z"
  }
}
```

**å›æ‡‰æ¬„ä½èªªæ˜**ï¼š

| æ¬„ä½ | é¡å‹ | èªªæ˜ |
|------|------|------|
| `action_required` | Integer | 0=ç„¡éœ€æ›´æ–°, 1=éœ€è¦æ›´æ–°, 2=éœ€è¦æ–°å¢ |
| `message` | String | æ“ä½œå»ºè­°è¨Šæ¯ |
| `existing_data` | Object | ç¾æœ‰å•†å“è³‡æ–™ï¼ˆè‹¥å­˜åœ¨ï¼‰ |

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šæŸ¥è©¢æˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**éŒ¯èª¤å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "error",
  "message": "å•†å“ç·¨è™Ÿä¸å¯ç‚ºç©º",
  "error_code": "MISSING_REQUIRED_FIELD",
  "field": "code"
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl -X POST http://localhost:5000/api/shoes/check-status \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "code": "ABC123",
    "price": "5000",
    "size": "27.0, 28.0"
  }'
```

---

#### 2.2 æ–°å¢å•†å“

**ç«¯é»**ï¼š`POST /shoes`

**æè¿°**ï¼šæ–°å¢ä¸€ç­†å•†å“è³‡æ–™

**æ¬Šé™**ï¼šWRITE

**è«‹æ±‚æ¨™é ­**ï¼š
```http
Content-Type: application/json
X-API-Key: your-api-key
```

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "name": "ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹",
  "eng_name": "Nike Air Max",
  "code": "ABC123",
  "hope_price": "8000",
  "price": "5000",
  "point": "500",
  "size": "27.0, 28.0, 29.0"
}
```

**è«‹æ±‚åƒæ•¸èªªæ˜**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ | é™åˆ¶ |
|------|------|------|------|------|
| `name` | String | æ˜¯ | å•†å“åç¨±ï¼ˆæ—¥æ–‡ï¼‰ | æœ€é•· 200 å­—å…ƒ |
| `eng_name` | String | æ˜¯ | å•†å“åç¨±ï¼ˆè‹±æ–‡ï¼‰ | æœ€é•· 200 å­—å…ƒ |
| `code` | String | æ˜¯ | å•†å“ç·¨è™Ÿ | 3-50 å­—å…ƒï¼Œå”¯ä¸€å€¼ |
| `hope_price` | String | å¦ | å¸Œæœ›å”®åƒ¹ | æœ€é•· 20 å­—å…ƒ |
| `price` | String | æ˜¯ | å¯¦éš›å”®åƒ¹ | æœ€é•· 20 å­—å…ƒ |
| `point` | String | å¦ | ç´…åˆ©é»æ•¸ | æœ€é•· 20 å­—å…ƒ |
| `size` | String | å¦ | å¯ç”¨å°ºå¯¸ | æœ€é•· 500 å­—å…ƒ |

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "å•†å“æ–°å¢æˆåŠŸ",
  "data": {
    "id": 124,
    "name": "ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹",
    "eng_name": "Nike Air Max",
    "code": "ABC123",
    "hope_price": "8000",
    "price": "5000",
    "point": "500",
    "size": "27.0, 28.0, 29.0",
    "created_at": "2026-02-08T10:30:00Z",
    "updated_at": "2026-02-08T10:30:00Z"
  }
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `201 Created`ï¼šå•†å“æ–°å¢æˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `409 Conflict`ï¼šå•†å“ç·¨è™Ÿå·²å­˜åœ¨
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**éŒ¯èª¤å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "error",
  "message": "å•†å“ç·¨è™Ÿå·²å­˜åœ¨",
  "error_code": "DUPLICATE_CODE",
  "field": "code",
  "value": "ABC123"
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl -X POST http://localhost:5000/api/shoes \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "name": "ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹",
    "eng_name": "Nike Air Max",
    "code": "ABC123",
    "price": "5000"
  }'
```

---

#### 2.3 æ›´æ–°å•†å“

**ç«¯é»**ï¼š`PUT /shoes/{code}`

**æè¿°**ï¼šæ›´æ–°æŒ‡å®šå•†å“çš„è³‡æ–™ï¼ˆåƒ…æ›´æ–°åƒ¹æ ¼èˆ‡å°ºå¯¸ï¼‰

**æ¬Šé™**ï¼šWRITE

**è·¯å¾‘åƒæ•¸**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `code` | String | æ˜¯ | å•†å“ç·¨è™Ÿ |

**è«‹æ±‚æ¨™é ­**ï¼š
```http
Content-Type: application/json
X-API-Key: your-api-key
```

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "price": "4500",
  "size": "27.0, 28.0, 29.0, 30.0"
}
```

**è«‹æ±‚åƒæ•¸èªªæ˜**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `price` | String | æ˜¯ | æ›´æ–°å¾Œçš„åƒ¹æ ¼ |
| `size` | String | æ˜¯ | æ›´æ–°å¾Œçš„å°ºå¯¸ |

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "å•†å“è³‡æ–™æ›´æ–°æˆåŠŸ",
  "updated_fields": ["price", "size"],
  "data": {
    "code": "ABC123",
    "price": "4500",
    "size": "27.0, 28.0, 29.0, 30.0",
    "updated_at": "2026-02-08T10:35:00Z"
  }
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šæ›´æ–°æˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `404 Not Found`ï¼šå•†å“ä¸å­˜åœ¨
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**éŒ¯èª¤å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "error",
  "message": "å•†å“ä¸å­˜åœ¨",
  "error_code": "PRODUCT_NOT_FOUND",
  "code": "ABC999"
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl -X PUT http://localhost:5000/api/shoes/ABC123 \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{
    "price": "4500",
    "size": "27.0, 28.0, 29.0, 30.0"
  }'
```

---

#### 2.4 åˆªé™¤å•†å“

**ç«¯é»**ï¼š`DELETE /shoes/{code}`

**æè¿°**ï¼šåˆªé™¤æŒ‡å®šå•†å“

**æ¬Šé™**ï¼šDELETE

**è·¯å¾‘åƒæ•¸**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `code` | String | æ˜¯ | å•†å“ç·¨è™Ÿ |

**è«‹æ±‚æ¨™é ­**ï¼š
```http
X-API-Key: your-api-key
```

**è«‹æ±‚åƒæ•¸**ï¼šç„¡

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "å•†å“ ABC123 å·²åˆªé™¤",
  "deleted_code": "ABC123"
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šåˆªé™¤æˆåŠŸ
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `404 Not Found`ï¼šå•†å“ä¸å­˜åœ¨
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl -X DELETE http://localhost:5000/api/shoes/ABC123 \
  -H "X-API-Key: your-api-key"
```

---

#### 2.5 å–å¾—æ‰€æœ‰å•†å“ç·¨è™Ÿ

**ç«¯é»**ï¼š`GET /shoes/codes`

**æè¿°**ï¼šå–å¾—æ‰€æœ‰å•†å“çš„ç·¨è™Ÿæ¸…å–®

**æ¬Šé™**ï¼šREAD

**è«‹æ±‚æ¨™é ­**ï¼š
```http
X-API-Key: your-api-key
```

**æŸ¥è©¢åƒæ•¸**ï¼ˆé¸å¡«ï¼‰ï¼š

| åƒæ•¸ | é¡å‹ | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `limit` | Integer | ç„¡é™åˆ¶ | é™åˆ¶å›å‚³æ•¸é‡ |
| `offset` | Integer | 0 | åç§»é‡ï¼ˆåˆ†é ç”¨ï¼‰ |

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "total": 150,
  "count": 150,
  "codes": [
    "ABC123",
    "DEF456",
    "GHI789",
    "..."
  ]
}
```

**å›æ‡‰æ¬„ä½èªªæ˜**ï¼š

| æ¬„ä½ | é¡å‹ | èªªæ˜ |
|------|------|------|
| `total` | Integer | ç¸½å•†å“æ•¸ |
| `count` | Integer | æœ¬æ¬¡å›å‚³æ•¸é‡ |
| `codes` | Array[String] | å•†å“ç·¨è™Ÿé™£åˆ— |

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šæŸ¥è©¢æˆåŠŸ
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
# å–å¾—æ‰€æœ‰ç·¨è™Ÿ
curl -X GET http://localhost:5000/api/shoes/codes \
  -H "X-API-Key: your-api-key"

# åˆ†é æŸ¥è©¢
curl -X GET http://localhost:5000/api/shoes/codes?limit=50&offset=0 \
  -H "X-API-Key: your-api-key"
```

---

#### 2.6 æ¸…ç©ºå±•ç¤ºè³‡æ–™è¡¨

**ç«¯é»**ï¼š`DELETE /shoes/clear/{table_name}`

**æè¿°**ï¼šæ¸…ç©ºæŒ‡å®šçš„è³‡æ–™è¡¨ï¼ˆåƒ…é™å…è¨±çš„è³‡æ–™è¡¨ï¼‰

**æ¬Šé™**ï¼šDELETE + ADMIN

**è·¯å¾‘åƒæ•¸**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `table_name` | String | æ˜¯ | è³‡æ–™è¡¨åç¨± |

**å…è¨±æ¸…ç©ºçš„è³‡æ–™è¡¨**ï¼š
- `shoes_show_inf`ï¼ˆå±•ç¤ºç”¨è³‡æ–™è¡¨ï¼‰

**è«‹æ±‚æ¨™é ­**ï¼š
```http
Content-Type: application/json
X-API-Key: your-api-key
```

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "confirm": true
}
```

**è«‹æ±‚åƒæ•¸èªªæ˜**ï¼š

| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `confirm` | Boolean | æ˜¯ | ç¢ºèªæ“ä½œï¼ˆå¿…é ˆç‚º trueï¼‰ |

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "è³‡æ–™è¡¨ shoes_show_inf å·²æ¸…ç©º",
  "table_name": "shoes_show_inf",
  "deleted_count": 45
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šæ¸…ç©ºæˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤æˆ–æœªç¢ºèª
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `403 Forbidden`ï¼šä¸å…è¨±æ¸…ç©ºæ­¤è³‡æ–™è¡¨
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

**éŒ¯èª¤å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "error",
  "message": "ä¸å…è¨±æ¸…ç©ºæ­¤è³‡æ–™è¡¨",
  "error_code": "TABLE_NOT_ALLOWED",
  "table_name": "shoes_inf",
  "allowed_tables": ["shoes_show_inf"]
}
```

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl -X DELETE http://localhost:5000/api/shoes/clear/shoes_show_inf \
  -H "Content-Type: application/json" \
  -H "X-API-Key: your-api-key" \
  -d '{"confirm": true}'
```

---

### 3. æ‰¹æ¬¡æ“ä½œ

#### 3.1 æ‰¹æ¬¡æ–°å¢å•†å“

**ç«¯é»**ï¼š`POST /shoes/batch`

**æè¿°**ï¼šä¸€æ¬¡æ–°å¢å¤šç­†å•†å“è³‡æ–™

**æ¬Šé™**ï¼šWRITE

**è«‹æ±‚æ¨™é ­**ï¼š
```http
Content-Type: application/json
X-API-Key: your-api-key
```

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "products": [
    {
      "name": "ãƒŠã‚¤ã‚­ ã‚¨ã‚¢ãƒãƒƒã‚¯ã‚¹",
      "eng_name": "Nike Air Max",
      "code": "ABC123",
      "price": "5000"
    },
    {
      "name": "ã‚¢ãƒ‡ã‚£ãƒ€ã‚¹ ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¹ã‚¿ãƒ¼",
      "eng_name": "Adidas Superstar",
      "code": "DEF456",
      "price": "6000"
    }
  ]
}
```

**è«‹æ±‚é™åˆ¶**ï¼š
- å–®æ¬¡æœ€å¤š 100 ç­†å•†å“

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "æ‰¹æ¬¡æ–°å¢å®Œæˆ",
  "total": 2,
  "success_count": 2,
  "failed_count": 0,
  "results": [
    {
      "code": "ABC123",
      "status": "created",
      "id": 124
    },
    {
      "code": "DEF456",
      "status": "created",
      "id": 125
    }
  ]
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `201 Created`ï¼šå…¨éƒ¨æ–°å¢æˆåŠŸ
- `207 Multi-Status`ï¼šéƒ¨åˆ†æˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤
- `401 Unauthorized`ï¼šæœªæˆæ¬Š
- `500 Internal Server Error`ï¼šä¼ºæœå™¨éŒ¯èª¤

---

#### 3.2 æ‰¹æ¬¡æ›´æ–°å•†å“

**ç«¯é»**ï¼š`PUT /shoes/batch`

**æè¿°**ï¼šä¸€æ¬¡æ›´æ–°å¤šç­†å•†å“è³‡æ–™

**æ¬Šé™**ï¼šWRITE

**è«‹æ±‚ä¸»é«”**ï¼š
```json
{
  "updates": [
    {
      "code": "ABC123",
      "price": "4500",
      "size": "27.0, 28.0"
    },
    {
      "code": "DEF456",
      "price": "5500",
      "size": "26.0, 27.0"
    }
  ]
}
```

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "message": "æ‰¹æ¬¡æ›´æ–°å®Œæˆ",
  "total": 2,
  "success_count": 2,
  "failed_count": 0,
  "results": [
    {
      "code": "ABC123",
      "status": "updated"
    },
    {
      "code": "DEF456",
      "status": "updated"
    }
  ]
}
```

**HTTP ç‹€æ…‹ç¢¼**ï¼š
- `200 OK`ï¼šå…¨éƒ¨æ›´æ–°æˆåŠŸ
- `207 Multi-Status`ï¼šéƒ¨åˆ†æˆåŠŸ
- `400 Bad Request`ï¼šè«‹æ±‚åƒæ•¸éŒ¯èª¤
- `401 Unauthorized`ï¼šæœªæˆæ¬Š

---

## éŒ¯èª¤è™•ç†

### éŒ¯èª¤å›æ‡‰æ ¼å¼

æ‰€æœ‰éŒ¯èª¤å›æ‡‰éµå¾ªçµ±ä¸€æ ¼å¼ï¼š

```json
{
  "status": "error",
  "message": "éŒ¯èª¤è¨Šæ¯æè¿°",
  "error_code": "ERROR_CODE",
  "details": {
    "field": "å‡ºéŒ¯çš„æ¬„ä½",
    "value": "éŒ¯èª¤çš„å€¼"
  },
  "timestamp": "2026-02-08T10:30:00Z"
}
```

### éŒ¯èª¤ç¢¼å°ç…§è¡¨

| HTTP ç‹€æ…‹ç¢¼ | éŒ¯èª¤ç¢¼ | èªªæ˜ | è™•ç†å»ºè­° |
|------------|--------|------|---------|
| **400** | `MISSING_REQUIRED_FIELD` | ç¼ºå°‘å¿…å¡«æ¬„ä½ | æª¢æŸ¥è«‹æ±‚åƒæ•¸ |
| **400** | `INVALID_PARAMETER` | åƒæ•¸æ ¼å¼éŒ¯èª¤ | ç¢ºèªåƒæ•¸æ ¼å¼ |
| **400** | `INVALID_CODE_FORMAT` | å•†å“ç·¨è™Ÿæ ¼å¼éŒ¯èª¤ | ä½¿ç”¨æ­£ç¢ºçš„ç·¨è™Ÿæ ¼å¼ |
| **400** | `MISSING_CONFIRMATION` | ç¼ºå°‘ç¢ºèªåƒæ•¸ | åŠ å…¥ confirm: true |
| **401** | `UNAUTHORIZED` | æœªæˆæ¬Š | æä¾›æœ‰æ•ˆçš„ API Key |
| **401** | `INVALID_API_KEY` | API Key ç„¡æ•ˆ | æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢º |
| **401** | `EXPIRED_TOKEN` | Token å·²éæœŸ | é‡æ–°ç™»å…¥å–å¾—æ–° Token |
| **403** | `FORBIDDEN` | æ¬Šé™ä¸è¶³ | ç¢ºèªå¸³è™Ÿæ¬Šé™ç­‰ç´š |
| **403** | `TABLE_NOT_ALLOWED` | ä¸å…è¨±æ“ä½œæ­¤è³‡æ–™è¡¨ | ä½¿ç”¨å…è¨±çš„è³‡æ–™è¡¨ |
| **404** | `PRODUCT_NOT_FOUND` | å•†å“ä¸å­˜åœ¨ | ç¢ºèªå•†å“ç·¨è™Ÿæ˜¯å¦æ­£ç¢º |
| **409** | `DUPLICATE_CODE` | å•†å“ç·¨è™Ÿé‡è¤‡ | ä½¿ç”¨ä¸åŒçš„å•†å“ç·¨è™Ÿ |
| **429** | `RATE_LIMIT_EXCEEDED` | è¶…éè«‹æ±‚é™åˆ¶ | é™ä½è«‹æ±‚é »ç‡ |
| **500** | `INTERNAL_SERVER_ERROR` | ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤ | è¯ç¹«æŠ€è¡“æ”¯æ´ |
| **503** | `DATABASE_UNAVAILABLE` | è³‡æ–™åº«ç„¡æ³•é€£ç·š | ç¨å¾Œé‡è©¦æˆ–è¯ç¹«æŠ€è¡“æ”¯æ´ |

### éŒ¯èª¤è™•ç†ç¯„ä¾‹

```python
import requests

def create_product(api_key, product_data):
    headers = {
        'Content-Type': 'application/json',
        'X-API-Key': api_key
    }
    
    try:
        response = requests.post(
            'http://localhost:5000/api/shoes',
            json=product_data,
            headers=headers
        )
        
        if response.status_code == 201:
            return response.json()
        elif response.status_code == 409:
            error = response.json()
            print(f"å•†å“ç·¨è™Ÿé‡è¤‡: {error['value']}")
        elif response.status_code == 401:
            print("API Key ç„¡æ•ˆï¼Œè«‹æª¢æŸ¥èªè­‰è³‡è¨Š")
        else:
            error = response.json()
            print(f"éŒ¯èª¤: {error['message']}")
            
    except requests.RequestException as e:
        print(f"ç¶²è·¯éŒ¯èª¤: {e}")
```

---

## é™æµèˆ‡é…é¡

### é™æµè¦å‰‡

| èªè­‰æ–¹å¼ | æ¯åˆ†é˜ | æ¯å°æ™‚ | æ¯å¤© |
|---------|--------|--------|------|
| **ç„¡èªè­‰** | 10 | 100 | 1000 |
| **API Key (READ)** | 60 | 1000 | 10000 |
| **API Key (WRITE)** | 30 | 500 | 5000 |
| **API Key (ADMIN)** | 100 | 2000 | 20000 |

### é™æµæ¨™é ­

å›æ‡‰æœƒåŒ…å«ä»¥ä¸‹æ¨™é ­ï¼Œé¡¯ç¤ºé™æµè³‡è¨Šï¼š

```http
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 45
X-RateLimit-Reset: 1644318000
```

| æ¨™é ­ | èªªæ˜ |
|------|------|
| `X-RateLimit-Limit` | æ™‚é–“çª—å£å…§çš„è«‹æ±‚ä¸Šé™ |
| `X-RateLimit-Remaining` | å‰©é¤˜è«‹æ±‚æ¬¡æ•¸ |
| `X-RateLimit-Reset` | é™åˆ¶é‡ç½®çš„ Unix æ™‚é–“æˆ³ |

### è¶…éé™æµçš„å›æ‡‰

```json
{
  "status": "error",
  "message": "è¶…éè«‹æ±‚é™åˆ¶ï¼Œè«‹ç¨å¾Œå†è©¦",
  "error_code": "RATE_LIMIT_EXCEEDED",
  "retry_after": 60,
  "limit": 60,
  "window": "1 minute"
}
```

---

## åˆ†é æ©Ÿåˆ¶

### åˆ†é åƒæ•¸

æ”¯æ´åˆ†é çš„ API ç«¯é»å¯ä½¿ç”¨ä»¥ä¸‹æŸ¥è©¢åƒæ•¸ï¼š

| åƒæ•¸ | é¡å‹ | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `page` | Integer | 1 | é ç¢¼ï¼ˆå¾ 1 é–‹å§‹ï¼‰ |
| `per_page` | Integer | 50 | æ¯é ç­†æ•¸ |
| `limit` | Integer | 50 | é™åˆ¶ç­†æ•¸ï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰ |
| `offset` | Integer | 0 | åç§»é‡ï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰ |

### åˆ†é å›æ‡‰æ ¼å¼

```json
{
  "status": "success",
  "data": [...],
  "pagination": {
    "total": 150,
    "page": 1,
    "per_page": 50,
    "total_pages": 3,
    "has_next": true,
    "has_prev": false
  }
}
```

---

## éåŠŸèƒ½æ€§éœ€æ±‚

### æ•ˆèƒ½éœ€æ±‚

| é …ç›® | ç›®æ¨™å€¼ |
|------|--------|
| **å¹³å‡å›æ‡‰æ™‚é–“** | < 200ms |
| **95 ç™¾åˆ†ä½å›æ‡‰æ™‚é–“** | < 500ms |
| **æœ€å¤§å›æ‡‰æ™‚é–“** | < 2s |
| **ä¸¦ç™¼è«‹æ±‚** | â‰¥ 100 req/s |
| **å¯ç”¨æ€§** | â‰¥ 99.5% |

### å®‰å…¨éœ€æ±‚

1. **å‚³è¼¸åŠ å¯†**ï¼šæ­£å¼ç’°å¢ƒå¼·åˆ¶ä½¿ç”¨ HTTPS
2. **è¼¸å…¥é©—è­‰**ï¼šæ‰€æœ‰è¼¸å…¥å¿…é ˆé©—è­‰èˆ‡æ·¨åŒ–
3. **SQL æ³¨å…¥é˜²è­·**ï¼šä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢
4. **XSS é˜²è­·**ï¼šé©ç•¶ç·¨ç¢¼è¼¸å‡º
5. **CSRF é˜²è­·**ï¼šä½¿ç”¨ Token é©—è­‰
6. **æ—¥èªŒè¨˜éŒ„**ï¼šè¨˜éŒ„æ‰€æœ‰ API è«‹æ±‚èˆ‡éŒ¯èª¤

### ç›¸å®¹æ€§éœ€æ±‚

1. **ç€è¦½å™¨æ”¯æ´**ï¼šç¾ä»£ç€è¦½å™¨ï¼ˆChrome, Firefox, Safari, Edgeï¼‰
2. **HTTP ç‰ˆæœ¬**ï¼šHTTP/1.1, HTTP/2
3. **JSON è¦ç¯„**ï¼šRFC 8259
4. **æ—¥æœŸæ ¼å¼**ï¼šISO 8601
5. **å­—å…ƒç·¨ç¢¼**ï¼šUTF-8

---

## æ¸¬è©¦éœ€æ±‚

### æ¸¬è©¦ç’°å¢ƒ

æä¾›ä»¥ä¸‹æ¸¬è©¦ç’°å¢ƒï¼š

| ç’°å¢ƒ | URL | ç”¨é€” |
|------|-----|------|
| **é–‹ç™¼ç’°å¢ƒ** | `http://localhost:5000/api` | æœ¬åœ°é–‹ç™¼æ¸¬è©¦ |
| **æ¸¬è©¦ç’°å¢ƒ** | `http://test-api.example.com/api` | æ•´åˆæ¸¬è©¦ |
| **é å‚™ç’°å¢ƒ** | `https://staging-api.example.com/api` | ä¸Šç·šå‰é©—è­‰ |

### æ¸¬è©¦è³‡æ–™

æ¸¬è©¦ç’°å¢ƒæä¾›ä»¥ä¸‹æ¸¬è©¦è³‡æ–™ï¼š

- æ¸¬è©¦ API Keyï¼š`test_key_123456`
- æ¸¬è©¦å•†å“ç·¨è™Ÿï¼š`TEST001` ~ `TEST100`
- æ¸¬è©¦å¸³è™Ÿï¼š`test_user` / `test_password`

### æ¸¬è©¦æ¡ˆä¾‹

æä¾›ä»¥ä¸‹æ¸¬è©¦æ¡ˆä¾‹ï¼š

1. **åŠŸèƒ½æ¸¬è©¦**ï¼šæ‰€æœ‰ API ç«¯é»çš„åŸºæœ¬åŠŸèƒ½
2. **éŒ¯èª¤è™•ç†æ¸¬è©¦**ï¼šå„ç¨®éŒ¯èª¤æƒ…å¢ƒ
3. **æ•ˆèƒ½æ¸¬è©¦**ï¼šè² è¼‰æ¸¬è©¦èˆ‡å£“åŠ›æ¸¬è©¦
4. **å®‰å…¨æ¸¬è©¦**ï¼šèªè­‰ã€æˆæ¬Šã€æ³¨å…¥æ”»æ“Š
5. **æ•´åˆæ¸¬è©¦**ï¼šå®Œæ•´çš„çˆ¬èŸ²æµç¨‹

---

## ç›£æ§èˆ‡æ—¥èªŒ

### ç›£æ§æŒ‡æ¨™

éœ€ç›£æ§ä»¥ä¸‹æŒ‡æ¨™ï¼š

1. **è«‹æ±‚é‡**ï¼šæ¯ç§’è«‹æ±‚æ•¸ï¼ˆRPSï¼‰
2. **éŒ¯èª¤ç‡**ï¼š4xxã€5xx éŒ¯èª¤æ¯”ä¾‹
3. **å›æ‡‰æ™‚é–“**ï¼šå¹³å‡ã€P95ã€P99
4. **è³‡æ–™åº«æ•ˆèƒ½**ï¼šæŸ¥è©¢æ™‚é–“ã€é€£ç·šæ± ä½¿ç”¨ç‡
5. **ç³»çµ±è³‡æº**ï¼šCPUã€è¨˜æ†¶é«”ã€ç£ç¢Ÿ

### æ—¥èªŒæ ¼å¼

æ‰€æœ‰ API è«‹æ±‚éœ€è¨˜éŒ„ä»¥ä¸‹è³‡è¨Šï¼š

```json
{
  "timestamp": "2026-02-08T10:30:00Z",
  "request_id": "req_abc123",
  "method": "POST",
  "path": "/api/shoes",
  "status_code": 201,
  "response_time_ms": 45,
  "client_ip": "192.168.1.100",
  "user_agent": "Python/requests",
  "api_key": "***456",
  "error": null
}
```

---

## è®Šæ›´æ—¥èªŒ

### v1.0.0 (2026-02-08)

**æ–°å¢åŠŸèƒ½**ï¼š
- âœ… å•†å“ç‹€æ…‹æª¢æŸ¥ API
- âœ… å•†å“æ–°å¢ã€æ›´æ–°ã€åˆªé™¤ API
- âœ… å•†å“ç·¨è™ŸæŸ¥è©¢ API
- âœ… è³‡æ–™è¡¨æ¸…ç©º API
- âœ… å¥åº·æª¢æŸ¥ API
- âœ… API Key èªè­‰æ©Ÿåˆ¶
- âœ… é™æµæ©Ÿåˆ¶

**å¾…é–‹ç™¼åŠŸèƒ½**ï¼š
- ğŸ”² JWT èªè­‰
- ğŸ”² æ‰¹æ¬¡æ“ä½œ API
- ğŸ”² åˆ†é æŸ¥è©¢
- ğŸ”² å•†å“æœå°‹èˆ‡ç¯©é¸
- ğŸ”² åƒ¹æ ¼æ­·å²æŸ¥è©¢

---

## é™„éŒ„

### A. Postman Collection

æä¾› Postman Collection æª”æ¡ˆï¼ŒåŒ…å«æ‰€æœ‰ API ç«¯é»çš„ç¯„ä¾‹è«‹æ±‚ã€‚

**ä¸‹è¼‰é€£çµ**ï¼š`/docs/postman/shoe-api.postman_collection.json`

### B. OpenAPI è¦æ ¼

æä¾› OpenAPI 3.0 è¦æ ¼æª”æ¡ˆã€‚

**ä¸‹è¼‰é€£çµ**ï¼š`/docs/openapi/shoe-api-v1.yaml`

### C. SDK èˆ‡å®¢æˆ¶ç«¯

æä¾›ä»¥ä¸‹èªè¨€çš„ SDKï¼š

- Python SDK
- JavaScript/Node.js SDK
- PHP SDK

### D. å¸¸è¦‹å•é¡Œ (FAQ)

**Q1: API æœ‰ä½¿ç”¨è²»ç”¨å—ï¼Ÿ**
A: å…§éƒ¨ä½¿ç”¨å…è²»ï¼Œç¬¬ä¸‰æ–¹æ•´åˆéœ€å¦è¡Œæ´½è«‡ã€‚

**Q2: å¦‚ä½•ç”³è«‹ API Keyï¼Ÿ**
A: è«‹è¯ç¹«ç³»çµ±ç®¡ç†å“¡ç”³è«‹ã€‚

**Q3: å¯ä»¥åŒæ™‚ä½¿ç”¨å¤šå€‹ API Key å—ï¼Ÿ**
A: å¯ä»¥ï¼Œä¸åŒç”¨é€”å»ºè­°ä½¿ç”¨ä¸åŒçš„ API Keyã€‚

**Q4: API æœ‰ç‰ˆæœ¬æ·˜æ±°è¨ˆç•«å—ï¼Ÿ**
A: èˆŠç‰ˆæœ¬æœƒè‡³å°‘ç¶­è­· 12 å€‹æœˆå¾Œæ‰æ·˜æ±°ã€‚

**Q5: å¦‚ä½•å–å¾—æŠ€è¡“æ”¯æ´ï¼Ÿ**
A: è«‹é€éå…§éƒ¨ Slack é »é“æˆ– Email è¯ç¹«é–‹ç™¼åœ˜éšŠã€‚

---

## è¯çµ¡è³‡è¨Š

| é …ç›® | è³‡è¨Š |
|------|------|
| **é–‹ç™¼åœ˜éšŠ** | backend-team@example.com |
| **æŠ€è¡“æ”¯æ´** | support@example.com |
| **æ–‡ä»¶æ›´æ–°** | https://docs.api.example.com |
| **å•é¡Œå›å ±** | https://github.com/example/shoe-api/issues |

---

**æ–‡ä»¶çµæŸ**
